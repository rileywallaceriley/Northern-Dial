<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Northern Dial - All Killer, All CanCon. Independent Canadian radio station.">
    <meta name="theme-color" content="#CC3333">
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#CC3333">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#CC3333">

<!-- PWA Meta Tags -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Northern Dial">
<link rel="apple-touch-icon" href="https://i.imgur.com/XIAPd0N.png">

<!-- Manifest -->
<link rel="manifest" href="./manifest.json">

<title>Northern Dial - All Killer, All CanCon</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    html {
        background-color: #ffffff;
    }

    body {
        font-family: 'Roboto Condensed', sans-serif;
        background-color: #ffffff;
        color: #1a1a1a;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 20px;
        background-color: #ffffff;
    }

    .header {
        text-align: center;
        margin-bottom: 30px;
    }

    .logo-image {
        max-width: 500px;
        width: 100%;
        height: auto;
    }

    /* Custom Player Styles */
    .player-section {
        margin-bottom: 60px;
    }

    .custom-player {
        background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
        border: 5px solid #C33;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 8px 30px rgba(195, 51, 51, 0.4);
    }

    .player-controls {
        display: flex;
        align-items: center;
        gap: 20px;
        flex-wrap: wrap;
    }

    .play-pause-btn {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: linear-gradient(135deg, #C33, #8B2323);
        border: 3px solid #fff;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        flex-shrink: 0;
    }

    .play-pause-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 0 20px rgba(195, 51, 51, 0.8);
    }

    .play-pause-btn:active {
        transform: scale(0.95);
    }

    .play-icon, .pause-icon {
        color: white;
        font-size: 24px;
        font-weight: bold;
    }

    .pause-icon {
        display: none;
    }

    .play-pause-btn.playing .play-icon {
        display: none;
    }

    .play-pause-btn.playing .pause-icon {
        display: block;
    }

    .player-info {
        flex: 1;
        min-width: 200px;
    }

    .status-text {
        font-size: 0.9rem;
        color: #C33;
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-bottom: 8px;
        font-weight: 700;
    }

    .now-playing-text {
        font-size: 1.8rem;
        font-weight: 700;
        color: #ffffff;
        margin-bottom: 5px;
    }

    .artist-text {
        font-size: 1.2rem;
        color: #cccccc;
    }

    .volume-control {
        display: flex;
        align-items: center;
        gap: 10px;
        min-width: 150px;
    }

    .volume-icon {
        color: #C33;
        font-size: 20px;
    }

    .volume-slider {
        flex: 1;
        height: 6px;
        -webkit-appearance: none;
        appearance: none;
        background: #444;
        border-radius: 5px;
        outline: none;
    }

    .volume-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        background: #C33;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .volume-slider::-webkit-slider-thumb:hover {
        background: #ff4444;
        transform: scale(1.2);
    }

    .volume-slider::-moz-range-thumb {
        width: 18px;
        height: 18px;
        background: #C33;
        border-radius: 50%;
        cursor: pointer;
        border: none;
    }

    .content-columns {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
        margin-bottom: 70px;
    }

    .column {
        background: rgba(255, 255, 255, 0.7);
        border: 4px solid #1a1a1a;
        padding: 35px;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    }

    .column h2 {
        font-family: 'Oswald', sans-serif;
        font-size: 2rem;
        color: #C33;
        text-transform: uppercase;
        letter-spacing: 3px;
        margin-bottom: 20px;
        border-bottom: 3px solid #1a1a1a;
        padding-bottom: 10px;
    }

    .column p {
        line-height: 1.8;
        font-size: 1.05rem;
    }

    .shows-title {
        font-family: 'Bebas Neue', sans-serif;
        font-size: 3.5rem;
        text-align: center;
        letter-spacing: 8px;
        margin-bottom: 50px;
        text-shadow: 2px 2px 0 #C33;
    }

    .shows-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 30px;
    }

    .show-card {
        background: #1a1a1a;
        border: 5px solid #C33;
        border-radius: 8px;
        overflow: hidden;
        transition: all 0.4s ease;
        box-shadow: 0 5px 25px rgba(0,0,0,0.3);
    }

    .show-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 12px 35px rgba(0,0,0,0.4);
    }

    .show-image {
        width: 100%;
        height: auto;
        display: block;
        border-bottom: 3px solid #C33;
    }

    .show-content {
        padding: 25px;
    }

    .show-title {
        font-family: 'Oswald', sans-serif;
        font-size: 1.8rem;
        color: #F0F0F0;
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-bottom: 15px;
    }

    .show-description {
        color: #F0F0F0;
        line-height: 1.6;
        margin-bottom: 20px;
        font-size: 0.95rem;
        opacity: 0.9;
    }

    .show-time {
        color: #C33;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 0.9rem;
        background: rgba(195, 51, 51, 0.2);
        padding: 10px 14px;
        border-radius: 4px;
        display: inline-block;
        border: 1px solid rgba(195, 51, 51, 0.4);
    }

    /* Install Banner */
    .install-banner {
        position: fixed;
        bottom: 20px;
        left: 20px;
        right: 20px;
        background: linear-gradient(135deg, #C33, #8B2323);
        color: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 8px 30px rgba(195, 51, 51, 0.6);
        z-index: 10000;
        display: none;
        animation: slideUp 0.4s ease;
    }

    .install-banner.show {
        display: block;
    }

    .install-banner-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 15px;
        flex-wrap: wrap;
    }

    .install-banner-text {
        flex: 1;
        min-width: 200px;
    }

    .install-banner-title {
        font-family: 'Oswald', sans-serif;
        font-size: 1.2rem;
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .install-banner-subtitle {
        font-size: 0.9rem;
        opacity: 0.9;
    }

    .install-banner-buttons {
        display: flex;
        gap: 10px;
    }

    .install-btn, .dismiss-btn {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        font-weight: 700;
        cursor: pointer;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 1px;
        transition: all 0.3s ease;
    }

    .install-btn {
        background: white;
        color: #C33;
    }

    .install-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 15px rgba(255,255,255,0.3);
    }

    .dismiss-btn {
        background: rgba(255, 255, 255, 0.2);
        color: white;
    }

    .dismiss-btn:hover {
        background: rgba(255, 255, 255, 0.3);
    }

    /* Install Instructions Modal */
    .install-modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        z-index: 10001;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }

    .install-modal.show {
        display: flex;
    }

    .install-modal-content {
        background: white;
        border-radius: 12px;
        padding: 30px;
        max-width: 500px;
        width: 100%;
        max-height: 80vh;
        overflow-y: auto;
    }

    .install-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .install-modal-title {
        font-family: 'Oswald', sans-serif;
        font-size: 1.8rem;
        color: #C33;
        text-transform: uppercase;
    }

    .close-modal-btn {
        background: none;
        border: none;
        font-size: 2rem;
        color: #999;
        cursor: pointer;
        line-height: 1;
    }

    .install-modal-steps {
        margin-top: 20px;
    }

    .install-step {
        margin-bottom: 15px;
        padding: 15px;
        background: #f5f5f5;
        border-radius: 8px;
        border-left: 4px solid #C33;
    }

    .install-step-number {
        font-weight: 700;
        color: #C33;
        margin-bottom: 5px;
    }

    @keyframes slideUp {
        from {
            transform: translateY(100px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
        .content-columns {
            grid-template-columns: 1fr;
        }

        .shows-title {
            font-size: 2.5rem;
        }

        .logo-image {
            max-width: 90%;
        }

        .player-controls {
            justify-content: center;
        }

        .now-playing-text {
            font-size: 1.4rem;
        }

        .artist-text {
            font-size: 1rem;
        }

        .install-banner {
            bottom: 10px;
            left: 10px;
            right: 10px;
            padding: 15px;
        }

        .install-banner-content {
            flex-direction: column;
            align-items: stretch;
        }

        .install-banner-buttons {
            width: 100%;
            justify-content: stretch;
        }

        .install-btn, .dismiss-btn {
            flex: 1;
        }

        .install-modal-content {
            padding: 20px;
        }
    }
</style>

</head>
<body>
    <div class="container">

    <!-- Logo -->
    <header class="header">
        <img src="https://i.imgur.com/XIAPd0N.png" alt="Northern Dial Logo" class="logo-image">
    </header>
    
    <!-- Custom Player -->
    <section class="player-section">
        <div class="custom-player">
            <div class="player-controls">
                <button class="play-pause-btn" id="playPauseBtn">
                    <span class="play-icon">‚ñ∂</span>
                    <span class="pause-icon">‚ùö‚ùö</span>
                </button>
                
                <div class="player-info">
                    <div class="status-text" id="statusText">NOW PLAYING</div>
                    <div class="now-playing-text" id="songTitle">Northern Dial Radio</div>
                    <div class="artist-text" id="artistName">All Killer, All CanCon</div>
                </div>
                
                <div class="volume-control">
                    <span class="volume-icon">üîä</span>
                    <input type="range" min="0" max="100" value="70" class="volume-slider" id="volumeSlider">
                </div>
            </div>
        </div>
        
        <audio id="radioStream" preload="none">
            <source src="https://a10.asurahosting.com:7220/radio.mp3" type="audio/mpeg">
        </audio>
    </section>
    
    <!-- Two Column Content -->
    <div class="content-columns">
        
        <!-- About -->
        <div class="column">
            <h2>About</h2>
            <p>Northern Dial is an independent Canadian radio station built for people who actually care about music.</p>
            <p style="margin-top: 15px;">We're not an algorithm, not a corporate playlist, and not trying to sound like everything else. Northern Dial is programmed by time of day, mood, and intention ‚Äî the way radio used to feel ‚Äî but with a modern, all-Canadian lens.</p>
            <p style="margin-top: 15px;">From morning commutes to late-night drives, we spin pop, hip-hop, R&B, indie, rock, deep cuts, and new music from across the country. Some of it's familiar. Some of it's niche. All of it belongs here.</p>
            <p style="margin-top: 15px;">This station exists because Canadian music deserves space ‚Äî not just in quotas, but in context. We believe the best songs hit differently depending on the hour, the season, and where you are. So we built a station that moves with you.</p>
        </div>
        
        <!-- Recently Played -->
        <div class="column">
            <h2>Recently Played</h2>
            <iframe src="https://a10.asurahosting.com/public/northern_dial/history?theme=light" frameborder="0" allowtransparency="true" style="width: 100%; min-height: 300px; border: 0;"></iframe>
        </div>
        
    </div>
    
    <!-- Show Schedule -->
    <section class="shows-section">
        <h2 class="shows-title">On Air Daily</h2>
        <div class="shows-grid">
            
            <!-- Open Roads -->
            <div class="show-card">
                <img src="https://i.imgur.com/LJFSC1l.jpeg" alt="Open Roads" class="show-image">
                <div class="show-content">
                    <h3 class="show-title">Open Roads</h3>
                    <p class="show-description">A playlist that feels like sunrise and highways ‚Äî pop, indie, rock, R&B that moves with the morning.</p>
                    <div class="show-time">10:00 AM - 2:00 PM</div>
                </div>
            </div>
            
            <!-- Northern Bars -->
            <div class="show-card">
                <img src="https://i.imgur.com/38QC8zh.jpeg" alt="Northern Bars" class="show-image">
                <div class="show-content">
                    <h3 class="show-title">Northern Bars</h3>
                    <p class="show-description">A hip-hop forward block rooted in Canadian voices ‚Äî from golden era hits to new rap chemistry.</p>
                    <div class="show-time">2:00 PM - 10:00 PM</div>
                </div>
            </div>
            
            <!-- After Hours -->
            <div class="show-card">
                <img src="https://i.imgur.com/7X7rN10.jpeg" alt="After Hours" class="show-image">
                <div class="show-content">
                    <h3 class="show-title">After Hours</h3>
                    <p class="show-description">Late night vibes for deeper listening ‚Äî mellow beats, smooth grooves, edge-of-town energy.</p>
                    <div class="show-time">10:00 PM - 2:00 AM</div>
                </div>
            </div>
            
        </div>
    </section>
    
</div>

<!-- Install Banner -->
<div class="install-banner" id="installBanner">
    <div class="install-banner-content">
        <div class="install-banner-text">
            <div class="install-banner-title">Install Northern Dial</div>
            <div class="install-banner-subtitle">Add to your home screen for quick access</div>
        </div>
        <div class="install-banner-buttons">
            <button class="install-btn" id="installBtn">Install</button>
            <button class="dismiss-btn" id="dismissBtn">Later</button>
        </div>
    </div>
</div>

<!-- Install Instructions Modal -->
<div class="install-modal" id="installModal">
    <div class="install-modal-content">
        <div class="install-modal-header">
            <h2 class="install-modal-title">Install App</h2>
            <button class="close-modal-btn" id="closeModalBtn">&times;</button>
        </div>
        <div class="install-modal-steps" id="installSteps">
            <!-- Steps will be inserted by JavaScript -->
        </div>
    </div>
</div>

<script>
    // Register Service Worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./service-worker.js')
            .then(reg => console.log('Service Worker registered'))
            .catch(err => console.log('Service Worker registration failed'));
    }

    const audio = document.getElementById('radioStream');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const volumeSlider = document.getElementById('volumeSlider');
    const statusText = document.getElementById('statusText');
    const songTitle = document.getElementById('songTitle');
    const artistName = document.getElementById('artistName');

    // Set initial volume
    audio.volume = 0.7;

    // Update Media Session API
    function updateMediaSession(title, artist) {
        if ('mediaSession' in navigator) {
            navigator.mediaSession.metadata = new MediaMetadata({
                title: title,
                artist: artist,
                album: 'Northern Dial Radio',
                artwork: [
                    { src: 'https://i.imgur.com/XIAPd0N.png', sizes: '512x512', type: 'image/png' }
                ]
            });

            // Set up media session action handlers
            navigator.mediaSession.setActionHandler('play', () => {
                audio.play();
            });

            navigator.mediaSession.setActionHandler('pause', () => {
                audio.pause();
            });
        }
    }

    // Play/Pause functionality
    playPauseBtn.addEventListener('click', function() {
        if (audio.paused) {
            audio.play();
            playPauseBtn.classList.add('playing');
            statusText.textContent = 'LIVE NOW';
        } else {
            audio.pause();
            playPauseBtn.classList.remove('playing');
            statusText.textContent = 'PAUSED';
        }
    });

    // Volume control
    volumeSlider.addEventListener('input', function() {
        audio.volume = this.value / 100;
    });

    // Fetch current song info
    async function updateNowPlaying() {
        try {
            const response = await fetch('https://a10.asurahosting.com/api/nowplaying/northern_dial');
            const data = await response.json();
            
            if (data && data.now_playing && data.now_playing.song) {
                const song = data.now_playing.song;
                const title = song.title || 'Unknown Track';
                const artist = song.artist || 'Unknown Artist';
                
                songTitle.textContent = title;
                artistName.textContent = artist;
                
                // Update lock screen controls
                updateMediaSession(title, artist);
            }
        } catch (error) {
            console.log('Error fetching now playing:', error);
        }
    }

    // Update now playing every 10 seconds
    updateNowPlaying();
    setInterval(updateNowPlaying, 10000);

    // Update status when playing
    audio.addEventListener('playing', function() {
        statusText.textContent = 'LIVE NOW';
        updateMediaSession(songTitle.textContent, artistName.textContent);
    });

    audio.addEventListener('pause', function() {
        if (!audio.ended) {
            statusText.textContent = 'PAUSED';
        }
    });

    audio.addEventListener('error', function() {
        statusText.textContent = 'CONNECTION ERROR';
        playPauseBtn.classList.remove('playing');
    });

    // Install Banner Logic
    let deferredPrompt;
    const installBanner = document.getElementById('installBanner');
    const installModal = document.getElementById('installModal');
    const installBtn = document.getElementById('installBtn');
    const dismissBtn = document.getElementById('dismissBtn');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const installSteps = document.getElementById('installSteps');

    // Detect if already installed or dismissed
    const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
    const bannerDismissed = localStorage.getItem('installBannerDismissed');

    // Show banner if not installed and not dismissed
    if (!isStandalone && !bannerDismissed) {
        setTimeout(() => {
            installBanner.classList.add('show');
        }, 3000); // Show after 3 seconds
    }

    // Capture the beforeinstallprompt event (Android/Chrome)
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
    });

    // Detect platform and show appropriate instructions
    function getInstallInstructions() {
        const userAgent = navigator.userAgent.toLowerCase();
        const isIOS = /iphone|ipad|ipod/.test(userAgent);
        const isAndroid = /android/.test(userAgent);
        const isSafari = /safari/.test(userAgent) && !/chrome/.test(userAgent);

        if (isIOS || isSafari) {
            return `
                <div class="install-step">
                    <div class="install-step-number">Step 1</div>
                    <div>Tap the Share button <strong>‚éò</strong> in Safari</div>
                </div>
                <div class="install-step">
                    <div class="install-step-number">Step 2</div>
                    <div>Scroll down and tap <strong>"Add to Home Screen"</strong></div>
                </div>
                <div class="install-step">
                    <div class="install-step-number">Step 3</div>
                    <div>Tap <strong>"Add"</strong> in the top right</div>
                </div>
                <div class="install-step">
                    <div class="install-step-number">Step 4</div>
                    <div>Find Northern Dial on your home screen!</div>
                </div>
            `;
        } else if (isAndroid) {
            return `
                <div class="install-step">
                    <div class="install-step-number">Step 1</div>
                    <div>Tap the menu button <strong>‚ãÆ</strong> in Chrome</div>
                </div>
                <div class="install-step">
                    <div class="install-step-number">Step 2</div>
                    <div>Tap <strong>"Install app"</strong> or <strong>"Add to Home screen"</strong></div>
                </div>
                <div class="install-step">
                    <div class="install-step-number">Step 3</div>
                    <div>Tap <strong>"Install"</strong></div>
                </div>
                <div class="install-step">
                    <div class="install-step-number">Step 4</div>
                    <div>Northern Dial will appear on your home screen!</div>
                </div>
            `;
        } else {
            return `
                <div class="install-step">
                    <div class="install-step-number">Desktop</div>
                    <div>Look for an install icon <strong>‚äï</strong> in your browser's address bar, or check the browser menu for "Install Northern Dial" option.</div>
                </div>
            `;
        }
    }

    // Install button click
    installBtn.addEventListener('click', async () => {
        if (deferredPrompt) {
            // Android native install prompt
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            deferredPrompt = null;
            installBanner.classList.remove('show');
        } else {
            // Show manual instructions
            installSteps.innerHTML = getInstallInstructions();
            installModal.classList.add('show');
            installBanner.classList.remove('show');
        }
    });

    // Dismiss button
    dismissBtn.addEventListener('click', () => {
        installBanner.classList.remove('show');
        localStorage.setItem('installBannerDismissed', 'true');
    });

    // Close modal
    closeModalBtn.addEventListener('click', () => {
        installModal.classList.remove('show');
    });

    // Close modal on backdrop click
    installModal.addEventListener('click', (e) => {
        if (e.target === installModal) {
            installModal.classList.remove('show');
        }
    });
</script>
```

</body>
</html>